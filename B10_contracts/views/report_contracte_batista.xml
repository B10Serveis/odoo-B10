<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<template id="report_contracte_batista">
			<t t-call="web.html_container">
				<t t-set="data_report_margin_top"
					t-value="30" />
				<t t-set="data_report_header_spacing"
					t-value="25" />
				<t t-set="data_report_margin_bottom"
					t-value="25" />
				<t t-foreach="docs"
					t-as="doc">
					<t t-call="B10_contracts.report_contracte_batista_document"
						t-lang="doc.partner_id.lang" />
				</t>
			</t>
		</template>
		<template id="report_contracte_batista_document">
			<t t-set="doc"
				t-value="doc.with_context({'lang':doc.partner_id.lang})" />
			<!-- Header -->
			<div class="header">
				<div class="first-page">
					<!-- Multicompany -->
					<t t-if="not o and doc">
						<t t-set="o"
							t-value="doc" />
					</t>
					<t t-if="o and 'company_id' in o">
						<t t-set="company"
							t-value="o.company_id.sudo()" />
					</t>
					<t t-if="not o or not 'company_id' in o">
						<t t-set="company"
							t-value="res_company" />
					</t>
					<!-- CapÃ§alera -->
					<div class="row"
						id="b10_header">
						<!-- Logo esquerra -->
						<div class="col-6"
							id="b10_header_left">
							<img t-if="doc.company_id.logo"
								t-att-src="image_data_uri(doc.company_id.logo)"
								style="max-width: 200px; max-height: 150px;"/>
						</div>
						<!-- Dades Empresa dreta -->
						<div class="col-6"
							id="b10_header_right"
							style="padding:15px; padding-left:30px;">
							<p style="margin-bottom: 0; color:gray; font-size:0.75em;">
								<strong>
									<span t-if="company.name"
										t-field="company.name" />
								</strong>
								<br />
								<span t-if="company.vat">
									VAT:
									<span t-field="company.vat" />
								</span>
							</p>
							<p style="margin-bottom: 0; color:gray; font-size:0.75em; margin-bottom:10px">
								<span t-if="company.street"
									t-field="company.street" />
								<br />
								<span t-if="company.zip"
									t-field="company.zip" />
								<span> -</span>
								<span t-if="company.city"
									t-field="company.city" />
								<span> (</span>
								<span t-if="company.state_id.name"
									t-field="company.state_id.original_name" />
								<span>)</span>
								<br />
								<span t-if="company.phone">
									Tel:
									<span t-field="company.phone" />
								</span>
								<span t-if="company.email">
									Email:
									<span t-field="company.email" />
								</span>
								<br />
								<span t-if="company.website"
									t-field="company.website" />
							</p>
						</div>
					</div>
				</div>
			</div>
			<!-- Page -->
			<div class="article">
				<div class="container"
					style="margin-bottom:1em; padding-top:40px;">
					<!-- Client i Document -->
					<div class="row"
						id="b10_docinfo">
						<!-- Columna esquerra -->
						<div class="col-6"
							id="b10_docinfo_left">
							<!-- Dades contracte -->
							<span t-if="doc.name">
								<h5 style="border-bottom: 1px solid #c1c1c1; ">
									<strong>Contract</strong>
								</h5>
							</span>
							<p style="margin-bottom: 0;">
								<span t-if="doc.name">
									<span t-field="doc.name" />
								</span>
							</p>
							<p style="margin-bottom: 0;"
								t-if="doc.date_start and not doc.line_recurrence">
								<span>
									<strong>Date of start:</strong>
									<span t-field="doc.date_start" />
								</span>
							</p>
							<p style="margin-bottom: 0;"
								t-if="doc.date_end and not doc.line_recurrence">
								<span>
									<strong>Date of end:</strong>
									<span t-field="doc.date_end" />
								</span>
							</p>
							<p style="margin-bottom: 0;"
								t-if="doc.recurring_next_date and not doc.line_recurrence">
								<span>
									<strong>Date of next invoice:</strong>
									<span t-field="doc.recurring_next_date" />
								</span>
							</p>

						</div>
						<!-- Columna dreta -->
						<div class="col-6"
							style="margin-left: 20px;"
							id="b10_docinfo_right">
							<!-- Dades Client -->
							<h5>
								<strong>
									<span t-if="doc.partner_id.parent_id"
										t-field="doc.partner_id.parent_id" />
								</strong>
							</h5>
							<p style="margin-bottom: 0;">
								<span t-if="doc.partner_id.name"
									t-field="doc.partner_id.name" />
							</p>
							<p style="margin-bottom: 0;">
								<span t-if="doc.partner_id.comercial"
									t-field="doc.partner_id.comercial"/>
							</p>
							<p style="margin-bottom: 0;">
								<span t-if="doc.partner_id.street"
									t-field="doc.partner_id.street" />
								<span t-if="doc.partner_id.street2">
									,
									<span t-field="doc.partner_id.street2" />
								</span>
							</p>
							<p style="margin-bottom: 0;">
								<span t-if="doc.partner_id.zip">
									<span t-field="doc.partner_id.zip" />
									<span> -</span>
								</span>
								<span t-if="doc.partner_id.city"
									t-field="doc.partner_id.city" />
								<span t-if="doc.partner_id.state_id.name">
									(
									<span t-field="doc.partner_id.state_id.original_name" />
									<span>)</span>
								</span>
							</p>
							<p style="margin-bottom: 0;">
								<span t-if="doc.partner_id.vat">
									TIN:
									<span t-field="doc.partner_id.vat" />
								</span>
							</p>
						</div>
					</div>
				</div>
				<!-- Linies Contracte -->
				<t t-set="total"
					t-value="0" />
				<table class="table table-condensed table-striped"
					id="b10_linetable">
					<thead>
						<tr>
							<th>
								<strong>Description</strong>
							</th>
							<th class="text-right">
								<strong>Quantity</strong>
							</th>
							<th class="text-right">
								<strong>Unit Price</strong>
							</th>
							<th class="text-right">
								<strong>Price</strong>
							</th>
							<th class="text-right"
								t-if="doc.line_recurrence">
								<strong>Date Start</strong>
							</th>
							<th class="text-right"
								t-if="doc.line_recurrence">
								<strong>Date End</strong>
							</th>
							<th class="text-right"
								t-if="doc.line_recurrence">
								<strong>Date next invoice</strong>
							</th>
						</tr>
					</thead>
					<tbody class="contract_tbody">
						<t t-set="current_subtotal"
							t-value="0" />
						<t t-foreach="doc.contract_line_ids"
							t-as="l">
							<t t-set="current_subtotal"
								t-value="current_subtotal + l.price_subtotal" />
							<tr t-att-class="'bg-200 font-weight-bold o_line_section' if l.display_type == 'line_section' else 'font-italic o_line_note' if l.display_type == 'line_note' else ''">
								<t t-if="not l.display_type">
									<td>
										<span t-field="l.name" />
									</td>
									<td class="text-right">
										<span t-field="l.quantity" />
									</td>
									<td class="text-right">
										<span t-field="l.price_unit"
											t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
									</td>
									<td class="text-right">
										<span t-field="l.price_subtotal"
											t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
									</td>
									<td class="text-right"
										t-if="doc.line_recurrence">
										<span t-field="l.date_start" />
									</td>
									<td class="text-right"
										t-if="doc.line_recurrence">
										<span t-field="l.date_end" />
									</td>
									<td class="text-right"
										t-if="doc.line_recurrence">
										<span t-field="l.recurring_next_date" />
									</td>
									<t t-set="total"
										t-value="total + l.price_subtotal" />
								</t>
								<t t-if="l.display_type == 'line_section'">
									<td colspan="99">
										<span t-field="l.name" />
									</td>
									<t t-set="current_section"
										t-value="l" />
									<t t-set="current_subtotal"
										t-value="0" />
								</t>
								<t t-if="l.display_type == 'line_note'">
									<td colspan="99">
										<span t-field="l.name" />
									</td>
								</t>
							</tr>
							<t t-if="current_section and (l_last or doc.contract_line_ids[l_index+1].display_type == 'line_section')">
								<tr class="is-subtotal text-right">
									<td colspan="99">
										<strong class="mr16">Subtotal</strong>
										<span t-esc="current_subtotal"
											t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
									</td>
								</tr>
							</t>
						</t>
					</tbody>
				</table>
				<hr />
				<!-- Totals -->
				<div class="page"
					style="page-break-inside:avoid;">
					<div class="col-12">
						<p id="modification_info_p">
							<strong>Modifications</strong>
						</p>
						<table class="table table-sm">
							<thead>
								<tr>
									<th name="th_date">Date</th>
									<th name="th_description"
										class="text-right">Description</th>
								</tr>
							</thead>
							<tbody>
								<t t-foreach="o.modification_ids"
									t-as="notification_id">
									<tr>
										<td name="td_date">
											<span t-field="notification_id.date" />
										</td>
										<td name="td_description"
											class="text-right">
											<div t-field="notification_id.description" />
										</td>
									</tr>
								</t>
							</tbody>
						</table>
					</div>
					<div class="col-4 ml-auto">
						<table class="table table-sm">
							<tr class="border-black o_subtotal"
								style="">
								<td>
									<strong>Total</strong>
								</td>
								<td class="text-right">
									<span t-esc="total"
										t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
								</td>
							</tr>
						</table>
					</div>
				</div>
				<!-- Fi Totals -->
				<hr />
			</div>
			<!-- Footer -->
			<div class="footer">
				<div class="row"
					id="b10_footer">
					<div class="col-12">
						<div class="last-page">
							<div style="clear:left; display:block; color:gray; font-size:0.75em; text-align: center;">
								<p style="margin-bottom: 0; text-align: center;"> According to the GDPR, we inform you that we will
									process your personal data in order to carry out
									administrative, accounting and fiscal management. Data
									proportionately, the time required by a legal obligation will
									be retained and will not be transferred to third parties except
									legal provision required, or if necessary, prior consent of The
									interested party. It will be able to exercise the following
									rights on its personal data: right of access, rectification,
									erasure, oblate, limitation, opposition, portability and to
									withdraw the consent given, to the address indicated in this
									document. In addition, it will be able to contact the competent
									supervisory authority in the field of data protection by get
									additional information or file a complaint.
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</template>
	</data>
</odoo>